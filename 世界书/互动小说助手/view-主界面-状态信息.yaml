- 以下是故事中需要追踪的关键变量,以这些变量初始化当前状态: 
stat_data.场景状态: 
<%= JSON.stringify(getvar('stat_data.场景状态')) _%>

在场主要NPC资料: 
<%_ 
  var nps_list = getvar('stat_data.场景状态.在场的主要NPC');
  if (nps_list === undefined) nps_list = [];
  for (let i = 0; i < nps_list.length; i++) { 
    var npcName = getvar('stat_data.场景状态.在场的主要NPC')[i];
_%>
    NPC资料库.<%= npcName _%>: 
      <%= JSON.stringify(getvar('stat_data.NPC资料库.' + npcName)); _%>

    当前NPC固定属性对NPC的影响: 
    <%_ 
      var attrObj = getvar('stat_data.NPC固定属性.' + npcName);
      for(let i = 0; i<Object.keys(attrObj).length; i++){    
        var key = Object.keys(attrObj)[i];
        var level = attrObj[key].level;
        var exp = attrObj[key].exp;
    _%>
    <%= key _%>: <%= level _%>

    <%_ 
      var rules = getvar('stat_data.NPC固定属性规则.'+ npcName +'.' + key + '.对角色的影响规则')
      var isMax = level >= (Object.keys(rules).length -1 )
    _%>
        当前阶段: <%= rules[level]; _%> <%_ if(isMax){ _%> (最大阶段) <%_ }else{ _%>
      
        下一阶段: <%= rules[level+1]; _%>

        当前exp(0-100): <%= exp; _%>

        请根据当前阶段和下一阶段结合当前exp,平滑对NPC的影响<%_ } _%>

    <%_ } _%>

<%_ } _%>